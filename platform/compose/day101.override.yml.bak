services:
  # Disable legacy frontend defined in the base file
  frontend:
    profiles: ["disabled"]

  # NexGear storefront (Next.js) on :8080 -> :3000
  storefront:
    build:
      context: ./apps/storefront
    environment:
      - CATALOG_API_URL=http://catalog-api:8000
      - ORDERS_API_URL=http://orders-api:8000
      - PAYMENTS_API_URL=http://payments-api:8000
      - BFF_ENABLE_MOCKS=false
    ports:
      - "8080:3000"
    labels:
      - logging=promtail
      - loki_job=storefront
    depends_on:
      - catalog-api
      - orders-api
      - payments-api
      - pg
