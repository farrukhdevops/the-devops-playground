services:
  cadvisor:
    image: gcr.io/cadvisor/cadvisor:v0.47.2
    container_name: cadvisor
    privileged: true
    command:
      - --docker_only=true
      - --store_container_labels=true
      - --housekeeping_interval=10s
      - --event_storage_event_limit=default=0
      - --event_storage_age_limit=default=0
      # uncomment the next line only if labels still missing after step 3
      # - --docker=unix:///var/run/docker.sock
    volumes:
      - /:/rootfs:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - /sys:/sys:ro
      - /sys/fs/cgroup:/sys/fs/cgroup:ro
      - /var/lib/docker/:/var/lib/docker:ro
    expose:
      - "8080"
